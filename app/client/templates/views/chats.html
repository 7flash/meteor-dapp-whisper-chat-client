<template name="views_chats_aside">
    <nav>
        <ul>
            <li><button class="add-chat dapp-main-button">{{i18n 'whisper.app.buttons.newChat'}} <i class="icon-pencil"></i></button></li>
            <li class="{{isActivePath regex='public$'}}">
                <a href="{{pathFor route='chat' sessionKey='public'}}">{{i18n 'whisper.chat.texts.publicChat'}}</a>
            </li>
            {{#each chats}}
                <li class="{{isActivePath regex=_id}}">
                    <a href="{{pathFor route='chat' sessionKey=_id}}">
                        {{#if name}}
                            {{name}}
                        {{else}}
                            {{i18n 'whisper.chat.placeholder.unnamedChat'}}
                        {{/if}}

                        {{#if $gt unreadCount 0}}
                            <span class="dapp-count">{{unreadCount}}</span>
                        {{/if}}
                    </a>
                </li>
            {{/each}}
        </ul>
    </nav>
</template>


<template name="views_chats">

    {{#with currentIdentity}}
        <header class="dapp-content-header">
            <div class="whisper-user-chat-header">
                {{> elements_profileImage identity=identity class="dapp-small"}}
                
                <a href="{{pathFor route='userProfile' userId=identity}}" class="whisper-username">{{name}}</a> {{i18n 'whisper.chat.texts.talksAbout'}}
                <input type="text" value="{{myTopic}}" name="topic">
            </div>

            <textarea name="write-message" placeholder="{{i18n 'whisper.chat.placeholder.writeHere'}}"></textarea>
        </header>
    {{/with}}

    <!-- <div class="dapp-message">
        {{i18n 'whisper.chat.texts.invitePeople1'}}
        <a href="{{pathFor route='addUser'}}"><i class="icon-user-add"></i> {{i18n 'whisper.app.buttons.addUser'}}</a>
        {{i18n 'whisper.chat.texts.invitePeople2'}}
        <input type="text" value="whisperchat.eth/9183k1sd/" disabled>
    </div> -->

    {{#each messages}}
        <div class="whisper-chat-item {{#if isYou}}you{{/if}}">
            <div class="whisper-user-info">
                {{> elements_profileImage identity=from.identity class="dapp-small"}}
            </div>
            <small>
                <a href="{{pathFor route='userProfile' userId=from.identity}}" class="whisper-username">{{username from.identity}}</a>
                {{#if topic}}{{i18n 'commonWords.on'}} <button class="topic">{{topic}}</button>{{/if}} {{formatTime timestamp 'fromnow'}}
                {{#if edited}}
                    <i class="icon-pencil" title="{{i18n 'whisper.chat.texts.edited'}} {{formatTime edited 'fromnow'}}"></i>
                {{/if}}
                {{#if isYou}}
                    <button class="edit-message">{{i18n 'buttons.edit'}}</button>
                {{/if}}
            </small>

            <p>{{{message}}}</p>   

        </div>
    {{else}}
        <p>{{i18n 'whisper.chat.texts.noChats'}}</p>
    {{/each}}
   
</template>


<template name="views_chats_actionbar">
    <nav>
        <ul>
            <li>
                <a href="{{pathFor route='addUser' sessionKey=_id}}">
                    <i class="icon-user-add"></i>
                    Add Users
                </a>
            </li>
            <li>
                <button>
                    <i class="icon-bolt"></i>
                    Connect
                </button>
            </li>
            <li>
                <button class="leave-chat">
                    <i class="icon-logout"></i>
                    Leave Chat
                </button>
            </li>
        </ul>
    </nav>
</template>